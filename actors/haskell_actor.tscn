[gd_scene load_steps=24 format=3 uid="uid://cf243oyu5kvrf"]

[ext_resource type="PackedScene" uid="uid://dgx1b2mmmsdr5" path="res://render/employees/haskell/haskell_model.tscn" id="1"]
[ext_resource type="Script" path="res://actors/ActorVelocity.cs" id="3"]
[ext_resource type="Script" path="res://actors/ActorAnimator.cs" id="5"]
[ext_resource type="Script" path="res://actors/Haskell.cs" id="6"]
[ext_resource type="PackedScene" path="res://actors/actor_floor_indicator.tscn" id="7"]
[ext_resource type="Script" path="res://audio/footsteps/FootstepsController.cs" id="7_5g5gq"]
[ext_resource type="PackedScene" uid="uid://ccauejj4i4k3v" path="res://audio/footsteps/tile/footsteps_tile_fast.tscn" id="8_h2my1"]
[ext_resource type="PackedScene" uid="uid://cmq4kldjoormo" path="res://audio/footsteps/tile/footsteps_tile_medium.tscn" id="9_lim5r"]
[ext_resource type="PackedScene" uid="uid://2ae2lvic7v6g" path="res://audio/footsteps/tile/footsteps_tile_slow.tscn" id="10_0nb28"]
[ext_resource type="Script" path="res://arenas/FacingDirectionHandler.cs" id="11_862jn"]
[ext_resource type="Script" path="res://action_points/ActionPointHandler.cs" id="11_8632j"]
[ext_resource type="Script" path="res://entity_states/EntityStateHandler.cs" id="11_uh075"]
[ext_resource type="Script" path="res://entity_states/employee_states/IdleEntityState.cs" id="12_togsl"]
[ext_resource type="Script" path="res://entity_states/employee_states/MoveEntityState.cs" id="13_q5f80"]
[ext_resource type="Script" path="res://entity_states/employee_states/AlertEntityState.cs" id="14_hf8lc"]
[ext_resource type="Script" path="res://arena_actions/ActionHandler.cs" id="16_87xgg"]
[ext_resource type="Resource" uid="uid://cup25aeyo3fel" path="res://arena_actions/move_action.tres" id="17_xmxqu"]
[ext_resource type="Resource" uid="uid://cqxeimysjvp16" path="res://arena_actions/move_sub_action.tres" id="18_64csj"]
[ext_resource type="Script" path="res://tiles/TileMovementHandler.cs" id="19_dsksq"]
[ext_resource type="Script" path="res://util/command/CommandProcessor.cs" id="20_1bpch"]
[ext_resource type="PackedScene" uid="uid://ik8hrd21pgrq" path="res://tiles/tilemap_position_handler.tscn" id="21_k5t6c"]
[ext_resource type="Script" path="res://demerits/DemeritHandler.cs" id="22_f48js"]

[sub_resource type="CapsuleShape3D" id="1"]
radius = 0.75

[node name="HaskellActor" type="CharacterBody3D" node_paths=PackedStringArray("_ActorAnimator", "_ActorVelocity", "_ActorFloorIndicator", "_TilemapPositionHandler", "_FacingDirectionHandler")]
script = ExtResource("6")
_ActorAnimator = NodePath("ActorAnimator")
_ActorVelocity = NodePath("ActorVelocity")
_ActorFloorIndicator = NodePath("ActorFloorIndicator")
Id = "haskell"
EntityName = "Haskell"
_TilemapPositionHandler = NodePath("TilemapPositionHandler")
_FacingDirectionHandler = NodePath("FacingDirectionHandler")

[node name="CollisionShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, -3.48787e-16, 3.48787e-16, 3.48787e-16, 1, -3.48787e-16, -3.48787e-16, 3.48787e-16, 1, 0, 1.25, 0)
shape = SubResource("1")

[node name="HaskellModel" parent="." instance=ExtResource("1")]

[node name="ActorVelocity" type="Node" parent="."]
script = ExtResource("3")

[node name="ActorAnimator" type="Node" parent="."]
script = ExtResource("5")
ModelPath = NodePath("../HaskellModel")

[node name="ActorFloorIndicator" parent="." instance=ExtResource("7")]

[node name="FootstepController" type="Node" parent="." node_paths=PackedStringArray("_SlowPlayer", "_MediumPlayer", "_FastPlayer")]
script = ExtResource("7_5g5gq")
_SlowPlayer = NodePath("FootstepsTileSlow")
_MediumPlayer = NodePath("FootstepsTileMedium")
_FastPlayer = NodePath("FootstepsTileFast")

[node name="FootstepsTileFast" parent="FootstepController" instance=ExtResource("8_h2my1")]

[node name="FootstepsTileMedium" parent="FootstepController" instance=ExtResource("9_lim5r")]

[node name="FootstepsTileSlow" parent="FootstepController" instance=ExtResource("10_0nb28")]

[node name="FacingDirectionHandler" type="Node" parent="." node_paths=PackedStringArray("FacingTarget")]
script = ExtResource("11_862jn")
FacingTarget = NodePath("..")

[node name="StateHandler" type="Node" parent="." node_paths=PackedStringArray("InitialState")]
script = ExtResource("11_uh075")
InitialState = NodePath("Idle")

[node name="Idle" type="Node" parent="StateHandler" node_paths=PackedStringArray("_Model")]
script = ExtResource("12_togsl")
_Model = NodePath("../../HaskellModel")
Id = "idle"

[node name="Move" type="Node" parent="StateHandler" node_paths=PackedStringArray("_Model")]
script = ExtResource("13_q5f80")
_Model = NodePath("../../HaskellModel")
Id = "move"

[node name="Alert" type="Node" parent="StateHandler" node_paths=PackedStringArray("_Model")]
script = ExtResource("14_hf8lc")
_Model = NodePath("../../HaskellModel")
Id = "alert"

[node name="ActionPointHandler" type="Node" parent="."]
script = ExtResource("11_8632j")

[node name="ActionHandler" type="Node" parent="."]
script = ExtResource("16_87xgg")
Actions = [ExtResource("17_xmxqu"), ExtResource("18_64csj")]

[node name="TileMovementHandler" type="Node" parent="." node_paths=PackedStringArray("_Body", "_CommandProcessor")]
script = ExtResource("19_dsksq")
_Body = NodePath("..")
_CommandProcessor = NodePath("CommandProcessor")
CanPassThroughAllies = true

[node name="CommandProcessor" type="Node" parent="TileMovementHandler"]
script = ExtResource("20_1bpch")

[node name="TilemapPositionHandler" parent="." instance=ExtResource("21_k5t6c")]

[node name="DemeritHandler" type="Node" parent="."]
script = ExtResource("22_f48js")

[connection signal="Footstep" from="HaskellModel" to="FootstepController" method="PlayFootstep"]
[connection signal="FacingDirectionChanged" from="FacingDirectionHandler" to="HaskellModel" method="SetFacingDir"]
[connection signal="TurnedToFaceDir" from="TileMovementHandler" to="FacingDirectionHandler" method="SetFacingDirection"]
