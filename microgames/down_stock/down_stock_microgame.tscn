[gd_scene load_steps=18 format=3 uid="uid://b1ppxbmllyau"]

[ext_resource type="PackedScene" uid="uid://ojwe5uopm5sn" path="res://microgames/null_microgame.tscn" id="1_uyyvq"]
[ext_resource type="Script" path="res://microgames/down_stock/DownStockMicrogame.cs" id="2_qvgbm"]
[ext_resource type="PackedScene" uid="uid://btq51h4r34rqd" path="res://microgames/down_stock/stock_items/box_stock_item_1.tscn" id="3_0xrbd"]
[ext_resource type="PackedScene" uid="uid://i8dgvdnkkinf" path="res://microgames/down_stock/stock_items/box_stock_item_2.tscn" id="4_2ppnn"]
[ext_resource type="PackedScene" uid="uid://521m8e8gm0lc" path="res://camera/screenshake_handler.tscn" id="4_3lfff"]
[ext_resource type="Script" path="res://util/MicrosleepHelper.cs" id="5_bkopa"]
[ext_resource type="PackedScene" uid="uid://cm3r8nnskgdh7" path="res://microgames/down_stock/stock_area.tscn" id="5_gad7r"]
[ext_resource type="PackedScene" uid="uid://bwqysmyhy5vfi" path="res://Models/Environment/Props/prop_shelf_aisle_empty_01_/prop_shelf_aisle_empty_01_.tscn" id="5_kbpfn"]
[ext_resource type="PackedScene" uid="uid://x80l22ngtps6" path="res://microgames/down_stock/stock_items/box_stock_item_3.tscn" id="5_qv7hc"]
[ext_resource type="PackedScene" uid="uid://b4q5pikas6gwx" path="res://microgames/down_stock/stock_items/box_stock_item_4.tscn" id="6_lfx6b"]
[ext_resource type="PackedScene" uid="uid://bgnqrxm61eght" path="res://microgames/down_stock/stock_items/box_stock_item_5.tscn" id="7_qd7k8"]
[ext_resource type="PackedScene" uid="uid://dag5gmhpoh4hr" path="res://Models/Environment/Props/Prop_ShoppingCartEmpty_.tscn" id="8_uwjcb"]
[ext_resource type="PackedScene" uid="uid://cmssnola8dosc" path="res://microgames/down_stock/grab_hand.tscn" id="9_114s0"]
[ext_resource type="Script" path="res://util/state_machine/StateMachine.cs" id="10_j5mte"]
[ext_resource type="Script" path="res://microgames/down_stock/HoveringDownStockState.cs" id="11_ycy5e"]
[ext_resource type="Script" path="res://microgames/down_stock/DraggingDownStockState.cs" id="12_evfrj"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_0pihj"]
size = Vector2(64, 1000)

[node name="DownStockMicrogame" instance=ExtResource("1_uyyvq")]
script = ExtResource("2_qvgbm")
StockItemScenes = Array[PackedScene]([ExtResource("3_0xrbd"), ExtResource("4_2ppnn"), ExtResource("5_qv7hc"), ExtResource("6_lfx6b"), ExtResource("7_qd7k8")])
PromptText = "Stock and Return!"
WidgetText = "Restock Shelves!"
DebugNoTimer = true

[node name="BackgroundRectangle" parent="." index="2"]
metadata/_edit_lock_ = true

[node name="ScreenshakeHandler" parent="." index="4" instance=ExtResource("4_3lfff")]
unique_name_in_owner = true

[node name="MicrosleepHelper" type="Node" parent="." index="5"]
script = ExtResource("5_bkopa")

[node name="StateMachine" type="Node" parent="." index="6"]
unique_name_in_owner = true
script = ExtResource("10_j5mte")

[node name="Hovering" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("_StockRaycast", "_GrabHand", "_Camera3D")]
script = ExtResource("11_ycy5e")
_StockRaycast = NodePath("../../ViewportContainer/Viewport/World/StockRaycast")
_GrabHand = NodePath("../../ViewportContainer/Viewport/World2D/GrabHand")
_Camera3D = NodePath("../../ViewportContainer/Viewport/World/Camera3D")

[node name="Dragging" type="Node" parent="StateMachine" index="1"]
script = ExtResource("12_evfrj")

[node name="ViewportContainer" type="SubViewportContainer" parent="." index="7"]
metadata/_edit_lock_ = true

[node name="Viewport" type="SubViewport" parent="ViewportContainer" index="0"]
own_world_3d = true
transparent_bg = true
handle_input_locally = false
size = Vector2i(940, 940)
render_target_update_mode = 4

[node name="World" type="Node3D" parent="ViewportContainer/Viewport" index="0"]

[node name="Camera3D" type="Camera3D" parent="ViewportContainer/Viewport/World" index="0"]
unique_name_in_owner = true
transform = Transform3D(1, -3.59134e-16, 3.48633e-16, 3.48633e-16, 0.99956, 0.0296662, -3.59134e-16, -0.0296662, 0.99956, -0.0692768, 1.35428, 5.24064)
cull_mask = 1
fov = 33.5
size = 2.5

[node name="OverstockItems" type="Node3D" parent="ViewportContainer/Viewport/World" index="1"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.08165e-12, 1.83, 0.5)

[node name="Spot1" type="Marker3D" parent="ViewportContainer/Viewport/World/OverstockItems" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 2.08165e-12, 2.08165e-12)

[node name="Spot2" type="Marker3D" parent="ViewportContainer/Viewport/World/OverstockItems" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.34, 2.08165e-12, 2.08165e-12)

[node name="Spot3" type="Marker3D" parent="ViewportContainer/Viewport/World/OverstockItems" index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.34, 2.08165e-12, 2.08165e-12)

[node name="Spot4" type="Marker3D" parent="ViewportContainer/Viewport/World/OverstockItems" index="3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 2.08165e-12, 2.08165e-12)

[node name="StockAreas" type="Node3D" parent="ViewportContainer/Viewport/World" index="2"]
unique_name_in_owner = true

[node name="StockArea" parent="ViewportContainer/Viewport/World/StockAreas" index="0" instance=ExtResource("5_gad7r")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0.8, 0.5)

[node name="StockArea4" parent="ViewportContainer/Viewport/World/StockAreas" index="1" instance=ExtResource("5_gad7r")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0.8, 0.5)

[node name="StockArea3" parent="ViewportContainer/Viewport/World/StockAreas" index="2" instance=ExtResource("5_gad7r")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0.285, 0.5)

[node name="StockArea2" parent="ViewportContainer/Viewport/World/StockAreas" index="3" instance=ExtResource("5_gad7r")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 1.3122, 0.5)

[node name="StockArea5" parent="ViewportContainer/Viewport/World/StockAreas" index="4" instance=ExtResource("5_gad7r")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1.312, 0.5)

[node name="PropShelfAisleEmpty01" parent="ViewportContainer/Viewport/World" index="3" instance=ExtResource("5_kbpfn")]

[node name="OverstockLabel" type="Label3D" parent="ViewportContainer/Viewport/World" index="4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.81783, 0.789903)
text = "Overstock"

[node name="Prop_ShoppingCartEmpty_" parent="ViewportContainer/Viewport/World" index="5" instance=ExtResource("8_uwjcb")]
transform = Transform3D(-4.37114e-08, 3.48787e-16, 1, 3.48787e-16, 1, -3.48787e-16, -1, 3.48787e-16, -4.37114e-08, 0.376632, 0.0824933, 2.2826)

[node name="ReturnsLabel" type="Label3D" parent="ViewportContainer/Viewport/World" index="6"]
transform = Transform3D(1, -3.48787e-16, 3.48787e-16, 3.48787e-16, 1, -3.48787e-16, -3.48787e-16, 3.48787e-16, 1, 0.376632, 0.632373, 2.54596)
text = "Returns"

[node name="StockRaycast" type="RayCast3D" parent="ViewportContainer/Viewport/World" index="7"]
unique_name_in_owner = true
collide_with_areas = true

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="ViewportContainer/Viewport/World" index="8"]
transform = Transform3D(0.888682, 0.318642, -0.329715, -0.0652654, 0.799661, 0.596895, 0.453856, -0.508931, 0.73144, 0, 2.84777, 2.98745)
light_energy = 0.5
shadow_enabled = true

[node name="World2D" type="Node2D" parent="ViewportContainer/Viewport" index="1"]
metadata/_edit_lock_ = true

[node name="Camera" type="Camera2D" parent="ViewportContainer/Viewport/World2D" index="0"]
unique_name_in_owner = true
anchor_mode = 0
metadata/_edit_lock_ = true

[node name="Arena" type="Node2D" parent="ViewportContainer/Viewport/World2D" index="1"]
metadata/_edit_lock_ = true

[node name="Bounds" type="Node2D" parent="ViewportContainer/Viewport/World2D/Arena" index="0"]
metadata/_edit_lock_ = true
metadata/_edit_group_ = true

[node name="Wall" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="0"]
position = Vector2(-35, 491)
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="Wall2" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="1"]
position = Vector2(974, 502)
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall2" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="Wall3" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="2"]
position = Vector2(473, -32)
rotation = 1.5708
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall3" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="Wall4" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="3"]
position = Vector2(457, 972)
rotation = 1.5708
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall4" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="GrabHand" parent="ViewportContainer/Viewport/World2D" index="2" instance=ExtResource("9_114s0")]
unique_name_in_owner = true
position = Vector2(470, 470)

[connection signal="Microsleep" from="." to="MicrosleepHelper" method="Microsleep"]
