[gd_scene load_steps=11 format=3 uid="uid://c1hrjv4smokox"]

[ext_resource type="PackedScene" uid="uid://ojwe5uopm5sn" path="res://microgames/null_microgame.tscn" id="1_o651h"]
[ext_resource type="PackedScene" uid="uid://521m8e8gm0lc" path="res://camera/screenshake_handler.tscn" id="2_k0og1"]
[ext_resource type="Script" path="res://microgames/break_down_boxes/BreakDownBoxesMicrogame.cs" id="2_olpor"]
[ext_resource type="Script" path="res://util/MicrosleepHelper.cs" id="3_kyqm3"]
[ext_resource type="PackedScene" uid="uid://c4nqfg4723jiv" path="res://microgames/break_down_boxes/box_cutter.tscn" id="3_l7anq"]
[ext_resource type="Texture2D" uid="uid://b1ga12w5a4miy" path="res://microgames/break_down_boxes/cuttable_tape_sprites.png" id="6_k8lkr"]
[ext_resource type="Texture2D" uid="uid://v1fjlkw1t0ng" path="res://microgames/common/bayer16.png" id="6_keadl"]
[ext_resource type="PackedScene" uid="uid://b8ppc5hohn44q" path="res://microgames/break_down_boxes/opening_box.gltf" id="8_yt8sl"]
[ext_resource type="PackedScene" uid="uid://b4v63n3dtgf0y" path="res://microgames/break_down_boxes/tape_manager.tscn" id="10_36hsx"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_0pihj"]
size = Vector2(64, 1000)

[node name="BreakDownBoxesMicrogame" node_paths=PackedStringArray("_BoxAnimPlayer") instance=ExtResource("1_o651h")]
script = ExtResource("2_olpor")
TapeManagerScene = ExtResource("10_36hsx")
_BoxAnimPlayer = NodePath("ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/AnimationPlayer")
PromptText = "Slash Tape!"
WidgetText = "Break Down Boxes"

[node name="BackgroundRectangle" parent="." index="2"]
metadata/_edit_lock_ = true

[node name="ScreenshakeHandler" parent="." index="4" instance=ExtResource("2_k0og1")]
unique_name_in_owner = true

[node name="MicrosleepHelper" type="Node" parent="." index="5"]
script = ExtResource("3_kyqm3")

[node name="ViewportContainer" type="SubViewportContainer" parent="." index="6"]
metadata/_edit_lock_ = true

[node name="Viewport" type="SubViewport" parent="ViewportContainer" index="0"]
own_world_3d = true
transparent_bg = true
handle_input_locally = false
size = Vector2i(940, 940)
render_target_update_mode = 4

[node name="World" type="Node3D" parent="ViewportContainer/Viewport" index="0"]

[node name="Camera3D" type="Camera3D" parent="ViewportContainer/Viewport/World" index="0"]
unique_name_in_owner = true
transform = Transform3D(1, -5.2318e-16, 3.02058e-16, 3.02058e-16, 0.866025, 0.5, -5.2318e-16, -0.5, 0.866025, 0, 1.97304, 5)
cull_mask = 1
projection = 1
size = 4.0

[node name="BoxRootPivot" type="Node3D" parent="ViewportContainer/Viewport/World" index="1"]
transform = Transform3D(0.707107, 1.60554e-24, 0.707107, 3.48787e-16, 1, -3.48787e-16, -0.707107, 4.93259e-16, 0.707107, 2.08165e-12, 2.08165e-12, 2)

[node name="BoxPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot" index="0"]
transform = Transform3D(1, 3.15962e-23, 1.2001e-08, -1.22604e-23, 1, 6.39887e-24, -7.57478e-09, -2.57347e-23, 1, 2.08165e-12, 2.08165e-12, 2.08165e-12)

[node name="opening_box" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot" index="0" instance=ExtResource("8_yt8sl")]
transform = Transform3D(1, -3.48787e-16, 3.48787e-16, 3.48787e-16, 1, -3.48787e-16, -3.48787e-16, 3.48787e-16, 1, 0, 0, 0)

[node name="Skeleton3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature" index="0"]
bones/0/rotation = Quaternion(0, 0, 0.707107, 0.707107)
bones/1/rotation = Quaternion(0, 0, -0.707107, 0.707107)
bones/2/rotation = Quaternion(0.737277, 0, 0, 0.67559)
bones/3/rotation = Quaternion(-0.737277, 0, 0, 0.67559)
bones/4/rotation = Quaternion(0.5, -0.5, -0.5, -0.5)
bones/5/rotation = Quaternion(0.5, 0.5, -0.5, 0.5)
bones/6/rotation = Quaternion(0.5, -0.5, -0.5, 0.5)
bones/7/rotation = Quaternion(0.5, 0.5, -0.5, -0.5)
bones/8/rotation = Quaternion(-0.707107, 0, 0, 0.707107)

[node name="TopLFlap" type="BoneAttachment3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D" index="1"]
transform = Transform3D(-2.38419e-07, -1, 0, 1, -2.38419e-07, 0, 0, 0, 1, 0, -0.00594574, 0)
bone_name = "top.L"
bone_idx = 0

[node name="FlapTipPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopLFlap" index="0"]
transform = Transform3D(1, 2.43413e-14, 6.51859e-15, 2.43413e-14, 1, 2.73409e-08, -8.18556e-17, -3.43327e-10, 1, 0, 1, 0)

[node name="TapeTopAligned1" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopLFlap/FlapTipPivot" index="0" groups=["bdb_tape", "bdb_top_aligned"]]
transform = Transform3D(0.25, -5.53514e-14, 5.8908e-16, 8.46238e-14, 0.25, 1.73719e-08, 3.36582e-16, -2.24376e-08, 0.25, 0.025, -0.16, 0.47)
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="TapeTopAligned2" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopLFlap/FlapTipPivot" index="1" groups=["bdb_tape", "bdb_top_aligned"]]
transform = Transform3D(0.25, -3.40351e-14, 5.8908e-16, 9.52819e-14, 0.25, 1.73719e-08, 3.36582e-16, -2.24376e-08, 0.25, 0.025, -0.16, -0.47)
flip_h = true
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="LeftPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopLFlap/FlapTipPivot" index="2"]
transform = Transform3D(1, 8.30673e-14, 3.1531e-15, 1.03259e-13, 1, 9.88312e-09, -5.21654e-15, 1.20011e-08, 1, 2.08165e-12, -0.5, -1)

[node name="TapeBackAligned1" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopLFlap/FlapTipPivot/LeftPivot" index="0" groups=["bdb_back_aligned", "bdb_tape"]]
transform = Transform3D(0.25, 2.04732e-17, 1.38003e-14, 3.37712e-14, -1.30075e-08, 0.25, -3.25245e-16, -0.25, -2.37159e-08, 0.023, 0.02, 0.158)
flip_h = true
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="RightPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopLFlap/FlapTipPivot" index="3"]
transform = Transform3D(1, 5.46456e-14, 3.1531e-15, 5.05783e-14, 1, 9.88312e-09, -9.3788e-15, 1.20011e-08, 1, 2.08165e-12, -0.5, 1)

[node name="TapeFrontAligned1" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopLFlap/FlapTipPivot/RightPivot" index="0" groups=["bdb_front_aligned", "bdb_tape"]]
transform = Transform3D(0.25, -4.51489e-16, -8.47123e-15, -1.57737e-15, -1.24304e-08, -0.25, 1.27259e-15, 0.25, -1.97093e-08, 0.023, 0.02, -0.156)
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="TopRFlap" type="BoneAttachment3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D" index="2"]
transform = Transform3D(-2.38419e-07, 1, 0, -1, -2.38419e-07, 0, 0, 0, 1, -2, -0.00594574, 0)
bone_name = "top.R"
bone_idx = 1

[node name="FlapTipPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopRFlap" index="0"]
transform = Transform3D(-1, 8.74228e-08, -3.48787e-16, 8.74228e-08, 1, 8.74228e-08, 7.99153e-15, 8.74228e-08, -1, 0, 1, 0)

[node name="TapeTopAligned3" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopRFlap/FlapTipPivot" index="0" groups=["bdb_tape", "bdb_top_aligned"]]
transform = Transform3D(0.25, -5.53514e-14, 5.8908e-16, 8.46238e-14, 0.25, 1.73719e-08, 3.36582e-16, -2.24376e-08, 0.25, 0.025, -0.16, 0.47)
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="TapeTopAligned4" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopRFlap/FlapTipPivot" index="1" groups=["bdb_tape", "bdb_top_aligned"]]
transform = Transform3D(0.25, -3.40351e-14, 5.8908e-16, 9.52819e-14, 0.25, 1.73719e-08, 3.36582e-16, -2.24376e-08, 0.25, 0.025, -0.16, -0.47)
flip_h = true
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="LeftPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopRFlap/FlapTipPivot" index="2"]
transform = Transform3D(1, 8.30673e-14, 3.1531e-15, 1.03259e-13, 1, 9.88312e-09, -5.21654e-15, 1.20011e-08, 1, 2.08165e-12, -0.5, -1)

[node name="TapeFrontAligned2" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopRFlap/FlapTipPivot/LeftPivot" index="0" groups=["bdb_front_aligned", "bdb_tape"]]
transform = Transform3D(0.25, 2.04732e-17, 1.02476e-14, 2.66658e-14, -1.30075e-08, 0.25, -3.25245e-16, -0.25, -2.37159e-08, 0.023, 0.02, 0.158)
flip_h = true
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="RightPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopRFlap/FlapTipPivot" index="3"]
transform = Transform3D(1, 5.46456e-14, 3.1531e-15, 5.05783e-14, 1, 9.88312e-09, -9.3788e-15, 1.20011e-08, 1, 2.08165e-12, -0.5, 1)

[node name="TapeBackAligned2" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/Armature/Skeleton3D/TopRFlap/FlapTipPivot/RightPivot" index="0" groups=["bdb_back_aligned", "bdb_tape"]]
transform = Transform3D(0.25, -2.11381e-09, -2.81109e-09, -3.27844e-09, 1.6943e-08, -0.25, -3.3238e-09, 0.25, -2.45225e-08, 0.023, 0.025, -0.156)
axis = 0
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="AnimationPlayer" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box" index="1"]
autoplay = "top_closed"

[node name="BoxSidePivotRoot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box" index="2"]
transform = Transform3D(1, 1.00315e-23, -4.47987e-08, -2.00959e-23, 1, -3.1819e-23, 1.26879e-08, 1.29622e-23, 1, 2.08165e-12, 2.08165e-12, 2.08165e-12)

[node name="TopPivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot" index="0"]
transform = Transform3D(1, -1.0747e-24, -2.50325e-08, 2.29576e-22, 1, -2.76654e-22, -2.50325e-08, 6.93622e-24, 1, 0, 1, 0)

[node name="TapeTopAlignedStartPoint" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/TopPivot" index="0" groups=["bdb_top_aligned"]]
transform = Transform3D(1, 8.00835e-24, -2.50325e-08, 7.98406e-23, 1, -7.3979e-23, -2.50325e-08, -2.14681e-24, 1, 2.08165e-12, 2.08165e-12, 0.8)

[node name="TapeTopAlignedEndPoint" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/TopPivot" index="1" groups=["bdb_top_aligned"]]
transform = Transform3D(1, -2.3003e-23, -2.50325e-08, 2.6901e-23, 1, -2.10395e-23, -2.50325e-08, 2.88645e-23, 1, 2.08165e-12, 2.08165e-12, -0.8)

[node name="FSidePivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot" index="1"]
transform = Transform3D(1, -2.31517e-23, -9.88305e-09, -2.95197e-22, 1, 1.36483e-23, 3.43455e-10, -2.0221e-23, 1, 0, 1, 1)

[node name="TapeFrontAligned3" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/FSidePivot" index="0" groups=["bdb_front_aligned", "bdb_tape"]]
transform = Transform3D(0.25, -1.89368e-09, 9.78976e-15, 2.66658e-14, -1.30075e-08, 0.25, -3.52979e-09, -0.25, -2.37159e-08, 0.475, -0.14, 0.003)
flip_h = true
flip_v = true
axis = 1
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="TapeFrontAligned4" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/FSidePivot" index="1" groups=["bdb_front_aligned", "bdb_tape"]]
transform = Transform3D(0.25, -1.89368e-09, 9.78976e-15, 2.66658e-14, -1.30075e-08, 0.25, -3.52978e-09, -0.25, -2.37159e-08, -0.475, -0.14, 0.003)
flip_v = true
axis = 1
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="TapeFrontAlignedStartPoint" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/FSidePivot" index="2" groups=["bdb_front_aligned"]]
transform = Transform3D(1, 2.08536e-23, -2.50325e-08, 1.14614e-22, 1, -1.08753e-22, -2.50325e-08, 3.79475e-23, 1, -0.8, 2.08165e-12, 2.08165e-12)

[node name="TapeFrontAlignedEndPoint" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/FSidePivot" index="3" groups=["bdb_front_aligned"]]
transform = Transform3D(1, 2.08536e-23, -2.50325e-08, 1.14614e-22, 1, -1.08753e-22, -2.50325e-08, 3.79475e-23, 1, 0.8, 2.08165e-12, 2.08165e-12)

[node name="BSidePivot" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot" index="2"]
transform = Transform3D(1, 4.0752e-23, -9.88305e-09, -4.01076e-22, 1, 1.36483e-23, 3.43455e-10, -9.25686e-24, 1, 0, 1, -1)

[node name="TapeBackAligned3" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/BSidePivot" index="0" groups=["bdb_back_aligned", "bdb_tape"]]
transform = Transform3D(0.25, -1.89368e-09, 9.78976e-15, 2.66658e-14, -1.30075e-08, 0.25, -3.52978e-09, -0.25, -2.37159e-08, 0.475, -0.14, -0.003)
flip_h = true
flip_v = true
axis = 1
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="TapeBackAligned4" type="Sprite3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/BSidePivot" index="1" groups=["bdb_back_aligned", "bdb_tape"]]
transform = Transform3D(0.25, -1.89368e-09, 9.78976e-15, 2.66658e-14, -1.30075e-08, 0.25, -3.52978e-09, -0.25, -2.37159e-08, -0.475, -0.14, -0.003)
flip_v = true
axis = 1
alpha_cut = 1
texture = ExtResource("6_k8lkr")
vframes = 3

[node name="TapeBackAlignedStartPoint" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/BSidePivot" index="2" groups=["bdb_back_aligned"]]
transform = Transform3D(1, 2.08536e-23, -2.50325e-08, 1.14614e-22, 1, -1.08753e-22, -2.50325e-08, 3.79475e-23, 1, -0.8, 2.08165e-12, 2.08165e-12)

[node name="TapeBackAlignedEndPoint" type="Node3D" parent="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box/BoxSidePivotRoot/BSidePivot" index="3" groups=["bdb_back_aligned"]]
transform = Transform3D(1, 2.08536e-23, -2.50325e-08, 1.14614e-22, 1, -1.08753e-22, -2.50325e-08, 3.79475e-23, 1, 0.8, 2.08165e-12, 2.08165e-12)

[node name="Dither" type="Sprite3D" parent="ViewportContainer/Viewport/World" index="2"]
unique_name_in_owner = true
transform = Transform3D(0.95035, -0.185295, 0.25, 0.25, 0.933013, -0.258819, -0.185295, 0.308469, 0.933013, -0.219462, 0.20729, 2.98201)
visible = false
modulate = Color(0.643137, 0, 0, 0.180392)
pixel_size = 0.125
texture = ExtResource("6_keadl")

[node name="World2D" type="Node2D" parent="ViewportContainer/Viewport" index="1"]
metadata/_edit_lock_ = true

[node name="Camera" type="Camera2D" parent="ViewportContainer/Viewport/World2D" index="0"]
unique_name_in_owner = true
anchor_mode = 0
metadata/_edit_lock_ = true

[node name="Arena" type="Node2D" parent="ViewportContainer/Viewport/World2D" index="1"]
metadata/_edit_lock_ = true

[node name="Bounds" type="Node2D" parent="ViewportContainer/Viewport/World2D/Arena" index="0"]
metadata/_edit_lock_ = true
metadata/_edit_group_ = true

[node name="Wall" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="0"]
position = Vector2(-35, 491)
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="Wall2" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="1"]
position = Vector2(974, 502)
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall2" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="Wall3" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="2"]
position = Vector2(473, -32)
rotation = 1.5708
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall3" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="Wall4" type="StaticBody2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="3"]
position = Vector2(457, 972)
rotation = 1.5708
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds/Wall4" index="0"]
shape = SubResource("RectangleShape2D_0pihj")

[node name="Node2D" type="Node2D" parent="ViewportContainer/Viewport/World2D/Arena/Bounds" index="4"]

[node name="BoxCutter" parent="ViewportContainer/Viewport/World2D" index="2" instance=ExtResource("3_l7anq")]
unique_name_in_owner = true
position = Vector2(795, 795)
collision_mask = 1
motion_mode = 1

[node name="TapePoints" type="Node2D" parent="ViewportContainer/Viewport/World2D" index="3"]
unique_name_in_owner = true
metadata/_edit_lock_ = true

[connection signal="Microsleep" from="." to="MicrosleepHelper" method="Microsleep"]

[editable path="ViewportContainer/Viewport/World/BoxRootPivot/BoxPivot/opening_box"]
